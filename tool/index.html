 <!DOCTYPE html>
<html class='mb-landing' data-server='CN' lang='zh-Hans-CN'>
<head>
<meta charset='utf-8'>
<meta content='ie=edge' http-equiv='x-ua-compatible'>
<meta content='width=device-width, initial-scale=1, maximum-scale=1' name='viewport'>
<meta content='webkit' name='renderer'>
<title>仿站工具箱-JellyCMS</title>
<meta content='仿站,在线仿站,仿站小工具,仿站工具,仿站工具箱,在线仿站工具,JellyCMS专用仿站工具箱,仿站工具免安装,仿站网页工具,仿站在线工具打包下载' name='keywords'>
<meta content='仿站工具箱是北京国栋科技有限公司研发的快速仿站小工具，特点是无需安装、在线仿站、配合JellyCMS使用效果更佳。' name='description'>
<link rel="stylesheet" href="layui/css/layui.css">
<link rel="stylesheet" media="screen" href="css/tool.css" />
<link rel="stylesheet" media="screen" href="font-awesome-4.7.0/css/font-awesome.min.css" />

</head>
<body>
<div class="app">
	<header>
		<img class="app-icon" src="images/imitate.png"/>仿站工具箱
	</header>
	<div class="toolbar">
		<ul>
			<li id="call-setting">配置</li>
			<li>下载报告</li>
			<li>帮助</li>
		</ul>
	</div>
 
	<div class="layui-tab layui-tab-brief" lay-filter="tab">
		<ul class="layui-tab-title">
			<li lay-id='step1' class="layui-this">第一步</li>
			<li lay-id='step2'>第二步</li>
			<li lay-id='step3'>第三步</li>
		</ul>
		<div class="layui-tab-content">
		<div class="layui-tab-item layui-show group">
			<fieldset class="layui-elem-field site-demo-button h100 ">
				<legend>页面列表</legend>
				<div class="step">
				<form class="layui-form" action="" id="form-url">
					<div class="layui-form-item">
						<label class="layui-form-label">输入网址</label>
						<div class="layui-input-block">
							<input type="text" name="url" lay-verify="required" autocomplete="off" placeholder="请输入完整网址" class="layui-input">
						</div>
					</div>
					<div class="layui-form-item">
						<div class="layui-inline">
							<label class="layui-form-label">相对路径</label>
							<div class="layui-input-inline">
								<input type="tel" name="path" value="/" lay-verify="required" autocomplete="off" class="layui-input">
							</div>
						</div>
						<div class="layui-inline">
							<label class="layui-form-label">文件名</label>
							<div class="layui-input-inline">
								<input type="text" name="name" lay-verify="required" value="index.html" autocomplete="off" class="layui-input">
							</div>
						</div>
						<div class="layui-inline">
							<button type="button" class="layui-btn layui-btn-sm add-url">添加</button>
						</div>
						<script type="text/html" id="operate-bar">
							<div class="layui-btn-group">
								<button type="button" class="layui-btn layui-btn-sm" title="编辑" lay-event="edit"><i class="layui-icon"></i></button>
								<button type="button" class="layui-btn layui-btn-sm layui-btn-danger" title="删除" lay-event="del"><i class="layui-icon"></i></button>
							</div>
						</script>
						
					</div>
				</form>
				</div>
			</fieldset>
			<table class="layui-hide" id="url-table" lay-filter="url-table"></table>
			<div class="operate step1">
				<button type="button" class="layui-btn layui-btn-normal layui-btn-sm layui-btn-disabled clear-url" disabled>清空网址</button>
				<button type="button" class="layui-btn layui-btn-normal layui-btn-sm layui-btn-disabled next" disabled>下一步</button>
			</div>
		</div>
		<div class="layui-tab-item">
			<fieldset class="layui-elem-field site-demo-button h100 ">
				<legend>下载准备</legend>
				<div class="step">
				<div class="site-text">
					<form class="layui-form" action="" id="ready-form" lay-filter="ready-form">
						<blockquote class="layui-elem-quote layui-quote-nm">
							<p><a name="base">网址列表</a></p>
							<textarea placeholder="" name="urllist" id="urllist" class="layui-textarea"></textarea>
						</blockquote>
						<blockquote class="layui-elem-quote layui-quote-nm">
							<div class="layui-form-item setting">
								<div class="layui-inline">
									<label class="layui-form-label">路径选择</label>
									<div class="layui-input-inline">
										<select name="path">
											<option value="relative">相对路径</option>
											<option value="absolute">绝对路径</option>
										</select>
									</div>
								</div>
								<div class="layui-inline">
									<label class="layui-form-label">模拟设备</label>
									<div class="layui-input-inline">
										<select name="fix" lay-verify="required" id="user-agent" lay-filter="user-agent">
											<option data-v="Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36" value="1">电脑Chrome</option>
											<option data-v="Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1" value="2">手机Chrome</option>
											<option data-v="Mozilla/5.0 (linux; android 7.1.1; mi 6 build/nmf26x; wv) applewebkit/537.36 (khtml, like gecko) version/4.0 chrome/53.0.2785.49 mobile mqqbrowser/6.2 tbs/043632 safari/537.36 micromessenger/6.6.1200(0x26060031) nettype/wifi language/zh_cn" value="3">手机微信</option>
											<option data-v="Mozilla/5.0 (Linux; Android 5.1; OPPO R9tm Build/LMY47I; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/53.0.2785.49 Mobile MQQBrowser/6.2 TBS/043128 Safari/537.36 V1_AND_SQ_7.0.0_676_YYB_D PA QQ/7.0.0.3135 NetType/4G WebP/0.3.0 Pixel/1080" value="4">手机QQ</option>
											<option data-v="Mozilla/5.0 (linux; u; android 6.0.1; zh-cn; mi 5 build/mxb48t) applewebkit/537.36 (khtml, like gecko) version/4.0 chrome/40.0.2214.89 ucbrowser/11.6.4.950 uws/2.11.0.39 mobile safari/537.36 ucbs/2.11.0.39 nebula nebulasdk/1.7.0 alipaydefined(nt:wifi,ws:360|0|3.0) aliapp(ap/10.1.10.1226101) alipayclient/10.1.10.1226101 language/zh-hans usestatusbar/true" value="5">手机支付宝</option>
											<option data-v="Mozilla/5.0 (compatible; Baiduspider/2.0; +http://www.baidu.com/search/spider.html)" value="6">百度蜘蛛</option>
											<option data-v="Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)" value="7">谷歌蜘蛛</option>
											<option data-v="Sogou web spider/4.0(+http://www.sogou.com/docs/help/webmasters.htm#07)" value="8">搜狗蜘蛛</option>
											<option data-v="Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0); 360Spider" value="9">360蜘蛛</option>
											<option data-v="" value="10">自定义UserAgent</option>
										</select>
									</div>
								</div>
								<div class="layui-inline userAgent">
									<input type="text" id="userAgent" name="userAgent" value="Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36" lay-verify="required" autocomplete="off" class="layui-input">
								</div>
							</div>
						</blockquote>
						<blockquote class="layui-elem-quote layui-quote-nm">
							<div class="layui-form-item mb0 cookie">
								<label class="layui-form-label">Cookie</label>
								<div class="layui-inline c-input">
									<input type="text" name="cookie" lay-verify="title" autocomplete="off" placeholder="一般不需要填写" class="layui-input">
								</div>
								<div class="layui-inline">
									<i id="get-cookie">如何使用cookie</i>
								</div>
							</div>
						</blockquote>
					</form>
				</div>
				</div>
			</fieldset>
			<div class="operate step2">
				<button type="button" class="layui-btn layui-btn-normal layui-btn-sm layui-btn-disabled pre" disabled>上一步</button>
				<button type="button" class="layui-btn layui-btn-normal layui-btn-sm layui-btn-disabled next" disabled>下一步</button>
			</div>
		</div>
		<div class="layui-tab-item">

			<p><a name="base">文件列表</a></p>
			<blockquote class="layui-elem-quote layui-quote-nm">
				<table class="layui-hide" id="srclist-table" lay-filter="srclist-table"></table>
			</blockquote>
			<blockquote class="layui-elem-quote layui-quote-nm">
				<div class="layui-progress">
					<div class="layui-progress-bar" lay-percent="0%"></div>
				</div>
			</blockquote>
			<div class="operate step3">
				<button type="button" class="layui-btn layui-btn-normal layui-btn-sm layui-btn-disabled pre" disabled>上一步</button>
				<button type="button" class="layui-btn layui-btn-normal layui-btn-sm start-down layui-btn-disabled" disabled>开始下载</button>
			</div>
		</div>
		</div>
	</div> 


<div id="setting">
	<div class="dialog">
		<form class="layui-form" action="" id="setting-form" lay-filter="setting-form">
		<blockquote class="layui-elem-quote layui-quote-nm">
			<div class="layui-form-item">
			<div class="layui-form-item">
				<label class="layui-form-label">目录样式</label>
				<div class="layui-input-block">
					<input type="radio" name="style" value="jellycms" title="Jelleycms目录结构" checked="">
					<input type="radio" name="style" value="normal" title="普通模式">
				</div>
			</div>
				<div class="layui-inline">
					<label class="layui-form-label">CSS目录</label>
					<div class="layui-input-inline">
						<input type="tel" name="csspath" value="/static/css/" lay-verify="required" autocomplete="off" class="layui-input">
					</div>
				</div>
				<div class="layui-inline">
					<label class="layui-form-label">JS目录</label>
					<div class="layui-input-inline">
						<input type="text" name="jspath" lay-verify="required" value="/static/js/" autocomplete="off" class="layui-input">
					</div>
				</div>
			</div>
			<div class="layui-form-item">
				<div class="layui-inline">
					<label class="layui-form-label">背景目录</label>
					<div class="layui-input-inline">
						<input type="tel" name="backgroundpath" value="/static/images/" lay-verify="required" autocomplete="off" class="layui-input">
					</div>
				</div>
				<div class="layui-inline">
					<label class="layui-form-label">图片目录</label>
					<div class="layui-input-inline">
						<input type="text" name="jspath" lay-verify="required" value="/static/picture/" autocomplete="off" class="layui-input">
					</div>
				</div>
			</div>
			<div class="layui-form-item">
				<div class="layui-inline">
					<label class="layui-form-label">FLASH目录</label>
					<div class="layui-input-inline">
						<input type="tel" name="flashpath" value="/static/flash/" lay-verify="required" autocomplete="off" class="layui-input">
					</div>
				</div>
				<div class="layui-inline">
					<label class="layui-form-label">字体目录</label>
					<div class="layui-input-inline">
						<input type="text" name="fontpath" lay-verify="required" value="/static/font/" autocomplete="off" class="layui-input">
					</div>
				</div>
			</div>
			<div class="layui-form-item">
				<div class="layui-inline">
					<label class="layui-form-label">目标编码</label>
					<div class="layui-input-inline">
						<select name="contentType">
							<option value="AUTO" selected>自动检测</option>
							<option value="ASCII">ASCII</option>
							<option value="UTF-8">UTF-8</option>
							<option value="UNICODE">UNICODE</option>
							<option value="GBK">GBK</option>
							<option value="GB2312">GB2312</option>
							<option value="BIG5">BIG5</option>
						</select>
					</div>
				</div>
				<div class="layui-inline">
					<label class="layui-form-label">编码转换</label>
					<div class="layui-input-inline">
						<select name="saveType">
							<option value="ORIGINAL">保留目标编码</option>
							<option value="ASCII">ASCII</option>
							<option value="UTF-8">UTF-8</option>
							<option value="UNICODE">UNICODE</option>
							<option value="GBK">GBK</option>
							<option value="GB2312">GB2312</option>
							<option value="BIG5">BIG5</option>
						</select>
					</div>
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">代码格式化</label>
				<div class="layui-input-block">
					<input type="checkbox" name="format[html]" lay-skin="primary" title="HTML内容格式化" checked>
					<input type="checkbox" name="format[css]" lay-skin="primary" title="CSS内容格式化" checked>
					<input type="checkbox" name="format[js]" lay-skin="primary" title="JS内容格式化" checked>
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">代码处理</label>
				<div class="layui-input-block">
					<input type="radio" name="codeoperate" value="package" title="打包下载" checked="">
					<input type="radio" name="codeoperate" value="preview" title="在线预览">
				</div>
			</div>
		</blockquote>
		</form>
	</div>
</div>








<div style="display:none;">
	仿站小工具是通过网址下载静态网页的工具。从输入的网址下载html代码，提取出JS、Css、Image、Picture、Flash等静态文件网址，
	再从下载完好的Css代码中提取出Image静态文件网址，
	通过网址下载静态文件，根据软件设置好的保存规则，自动修正html和css代码链接路径，最终这些静态文件被按分类保存到电脑文件夹。
</div>
<script src="layui/layui.js"></script>
<script>
//由于模块都一次性加载，因此不用执行 layui.use() 来加载对应模块，直接使用即可：
layui.use(['layer', 'form', 'table', 'element', 'jquery'], function(){
	var layer = layui.layer,form = layui.form;
	var table = layui.table;
	var element = layui.element;
	var $ = layui.jquery;
	var urlData = new Array();//url table data
	form.render();
	element.on('tab(tab)', function(data){
		//console.log(this); //当前Tab标题所在的原始DOM元素
		//console.log(data.index); //得到当前Tab的所在下标
		//console.log(data.elem); //得到当前的Tab大容器
		return false;
	});
	$('.step1 .next').click(function(){
		//生成下载链接
		$('#urllist').html('');
		$.each( urlData, function(i, n){
			$('#urllist').html($('#urllist').html() + n.url + "\r\n")
		});
		$('.step2 .pre').removeClass('layui-btn-disabled');
		$('.step2 .pre').attr({'disabled':false});
		$('.step2 .next').removeClass('layui-btn-disabled');
		$('.step2 .next').attr({'disabled':false});
		element.tabChange('tab', 'step2');
	})
	$('.step2 .pre').click(function(){
		element.tabChange('tab', 'step1');
	})
	$('.step2 .next').click(function(){
		$('.step3 .pre').removeClass('layui-btn-disabled');
		$('.step3 .pre').attr({'disabled':false});
		element.tabChange('tab', 'step3');
		layer.msg('请稍候，服务器正在生成资源列表', {
			icon: 6,
			time: 200000
			}, function(){
				layer.msg('列表加载完成');
		});
		//获取表单区域所有值
		var setting = form.val("setting-form");
		var ready = form.val("ready-form");
		$.ajax({
			type: "POST",
			url: "/index.php/fangzhan",
			data: {urllist: urlData, setting:setting, ready:ready},
			dataType:'json',
			success:function(data, textStatus){
				table.render({
					elem: '#srclist-table',
					data:data.data,
					layEvent: 'LAYTABLE_TIPS',
					icon: 'layui-icon-tips',
					cols: [[
						{field:'id', title:'ID', width:80, fixed: 'left', unresize: true, sort: true},
						{field:'url', title:'url'},
						{field:'path', width:260, title:'路径'},
						{field:'name', title:'文件名', width:180},
						{field:'status', title:'状态', width:66},
					]],
					done: function(res, curr, count){
						layer.closeAll();
					},
					page: true
				});
				$('.step3 .start-down').removeClass('layui-btn-disabled');
				$('.step3 .start-down').attr({'disabled':false});
			}
		});
	})
	$('.step3 .pre').click(function(){
		element.tabChange('tab', 'step2');
	})
	$('.step1 .clear-url').click(function(){
		urlData = new Array();
		urlTable.reload({data:urlData});
		$('.step1 .next').addClass('layui-btn-disabled');
		$('.step1 .next').attr({'disabled':true});
		$('.step1 .clear-url').attr({'disabled':true});
		$('.step1 .clear-url').addClass('layui-btn-disabled');
	})
	$('#call-setting').click(function(){
		layer.open({
			type: 1,
			title:'设置',
			area: ['660px', '400px'],
			content: $('#setting').html(),
			btn: ['确定', '取消'],
			yes: function(index, layero){
				layer.close(index);
			}
		});
		form.render();
	})
	$('#get-cookie').click(function(){
		layer.open({
			type: 2,
			title:'设置',
			area: ['660px', '400px'],
			content: '',
			success: function(layero, index){
			 var body = layer.getChildFrame('body', index);
			 var iframeWin = window[layero.find('iframe')[0]['name']]; //得到iframe页的窗口对象，执行iframe页的方法：iframeWin.method();
			 console.log(iframeWin) //得到iframe页的body内容
			// body.find('body').val('Hi，我是从父页来的')
			// iframeWin.child1();
			
		   },
			btn: ['确定', '取消'],
			yes: function(index, layero){
				layer.close(index);
			}
		});
		form.render();
	})
	$('.add-url').click(function(){
		if($('#form-url input[name="url"]').val() == ''){
			layer.msg('请输入网址');
			return false;
		}
		if(!isURL($('#form-url input[name="url"]').val())){
			layer.msg('请输入正确网址');
			return false;
		}
		if($('#form-url input[name="name"]').val() == ''){
			layer.msg('请输入文件名');
			return false;
		}
		urlData.unshift({
			url:$('#form-url input[name="url"]').val(), 
			path:$('#form-url input[name="path"]').val(), 
			name:$('#form-url input[name="name"]').val()
		});
		urlTable.reload({data:urlData});
		$('#form-url input[name="url"]').val('');
		$('#form-url input[name="name"]').val('');
		//解析按钮禁用
		if(urlData.length >0){
			$('.step1 .next').removeClass('layui-btn-disabled');
			$('.step1 .next').attr({'disabled':false});
			$('.step1 .clear-url').attr({'disabled':false});
			$('.step1 .clear-url').removeClass('layui-btn-disabled');
		}
		
		layer.msg('添加成功');
	})
	
	var urlTable = table.render({
		elem: '#url-table',
		data:urlData,
		title: '提示',
		icon: 'layui-icon-tips',
		text: {
			none: ' '
		},
		cols: [[
			{field:'id', title:'ID', width:46, fixed: 'left', unresize: true,templet: '#id'},
			{field:'url', title:'网址', edit:'text'},
			{field:'path', title:'路径',width:60, edit:'text'},
			{field:'name', title:'文件名', edit:'text'},
			{fixed: 'right', title:'操作', toolbar: '#operate-bar', width:105}
		]],
		page: true
	});
	form.on('select(user-agent)', function(data){
		var userAgent = $("#user-agent option:selected").attr('data-v');
		$('#userAgent').val(userAgent);
	})
	
	//监听行工具事件
	table.on('tool(url-table)', function(obj){
		var data = obj.data;
		if(obj.event === 'del'){
			layer.confirm('真的删除行么', function(index){
				obj.del();
				urlData = layui.table.cache["url-table"];
				//按钮禁用
				if(urlData.length >0){
					$('.step1 .next').addClass('layui-btn-disabled');
					$('.step1 .next').attr({'disabled':true});
					$('.step1 .clear-url').attr({'disabled':true});
					$('.step1 .clear-url').addClass('layui-btn-disabled');
				}
				layer.close(index);
			});
		}
	});

});
function isURL(url) {
　　const strRegex = '^((https|http|ftp)://)?'//(https或http或ftp):// 可有可无
　　+ '(([\\w_!~*\'()\\.&=+$%-]+: )?[\\w_!~*\'()\\.&=+$%-]+@)?' //ftp的user@ 可有可无
　　+ '(([0-9]{1,3}\\.){3}[0-9]{1,3}' // IP形式的URL- 3位数字.3位数字.3位数字.3位数字
　　+ '|' // 允许IP和DOMAIN（域名）
　　+ '(localhost)|'    //匹配localhost
　　+ '([\\w_!~*\'()-]+\\.)*' // 域名- 至少一个[英文或数字_!~*\'()-]加上.
　　+ '\\w+\\.' // 一级域名 -英文或数字 加上.
　　+ '[a-zA-Z]{1,6})' // 顶级域名- 1-6位英文
　　+ '(:[0-9]{1,5})?' // 端口- :80 ,1-5位数字
　　+ '((/?)|' // url无参数结尾 - 斜杆或这没有
　　+ '(/[\\w_!~*\'()\\.;?:@&=+$,%#-]+)+/?)$';//请求参数结尾- 英文或数字和[]内的各种字符
　　const re = new RegExp(strRegex, 'i'); // 大小写不敏感
　　if (re.test(encodeURI(url))) {
　　　　return true;
　　}
　　return false;
}
</script>
<script type="text/html" id="id">
	{{d.LAY_TABLE_INDEX+1}}
</script>
</body>
</html> 